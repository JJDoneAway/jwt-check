package main

import (
	"fmt"
	"jwt-check/oauth"
)

// https://dev-ekwvp-wi.us.auth0.com/.well-known/jwks.json
// https://johannes-address-book-ui.dev.sit.sys.odj.cloud/env
const jwtRaw string = "eyJraWQiOiI5MDk3MDM3OTI2MzI2NjAxMzUxOTgwOTkzNzQwODA3MjEzODkwOCIsInR5cCI6IkpXVCIsImFsZyI6IlJTMjU2In0.eyJpc3MiOiJodHRwczovL2ZlZGVyYXRpb24uYXV0aC5zY2h3YXJ6L25pZHAvb2F1dGgvbmFtIiwianRpIjoiNmUxZTg4MTMtNmUxMi00ZDNjLWI2NDktZDVmY2Q2NjE5ZWZlIiwiYXVkIjoiOWRlMGVmYjktNzY3ZS00NTNiLTg0ZmEtYTNiMGQ3NmM5N2JlIiwiZXhwIjoxNjcwNzg1NTMwLCJpYXQiOjE2NzA3ODE5MzAsIm5iZiI6MTY3MDc4MTkwMCwic3ViIjoiYzMxZTBlYmMxODhhYWY0NWJiYmFjMzFlMGViYzE4OGEiLCJfcHZ0IjoiTGRJSEdueDRQcVUwNFBCcFE1TkpzNnp5dmR0MGRKUnYyNzRMRjBaczhSTUlCMXNXMlNMNzBKRzduUnJaVWY2OWZ4OFovNG56THpMRGV1eVhGSDZDNlNCRTJXK3BQcUNJbTF2b2QxcHVZQUYzWllEV2trTVFMUzFvSzYwSU5zM1M4TkdXdUxZSWFub3hwQ0c2L20zY3UxU2kwM0dSbW5PT01BRUR5TDFaZzd1WkZDRjBHRjM3YlFOdzE5RW5Fc2w1VzZYVkJCYlBrU2pjUW1TcDVYNDN3TnBVcVB1QkNCSnZwRmwxVzlvOVVZcFViQlBjTFEyZHV0NlQ2bEJjd1lzQmoyWTNhK1FkU3krUG1NNmtvZ0I4OW9aMkxpNlFzTTFQekpYQXFLeU1LdndBOFRuczE5K2VZMTl5ZXRLVGluQXBGRUhrVUI5WkJ5OTVyZ2RuODNLNnRJUTdMNitYYWNsaFhPQ2tTNXdmNGZNaHFIM1BFZVpMbE9wc2lHTk1ETUpFb3JBM0dyb1FFNFdSUmxWdExhUCt3VTNIMkxEM2tSbXdqOUZ6eGRpZTl5UWtsUkY4ZUd1TjA4L0xrNHVZTThBbWF4UENMYTJVNGRGSk5JQVM2STNjdkk2U3M0RDNvbW5aQmdpc0N5ODlUb3AvK3VBWWNKNkh1L3dZS3NRWTl0ekhabDR2eTZST0VmN3VtUGhIRXFYNmo3cEc0YlpCc0pWKzBuRUJQcUFlOGp5Q3pHNU0xeTdYTk5BK0xucHBVbkJXLjkiLCJzY29wZSI6WyJzaWFtIiwicHJvZmlsZSJdLCJ1aWQiOiJob2VobmVqbyIsIm1haWwiOiJKb2hhbm5lcy5Ib2VobmVAbWFpbC5zY2h3YXJ6IiwiZ2l2ZW5OYW1lIjoiSm9oYW5uZXMiLCJuaWNrbmFtZSI6IjEwMDI0Njk3NjIiLCJmdWxsTmFtZSI6IkpvaGFubmVzIEjDtmhuZSIsInNuIjoiSMO2aG5lIiwiQ2xvdWRMb2dpbk5hbWUiOiJKb2hhbm5lcy5Ib2VobmVAbWFpbC5zY2h3YXJ6Iiwia2xDbG91ZExvZ2luTmFtZSI6IkpvaGFubmVzLkhvZWhuZUBtYWlsLnNjaHdhcnoiLCJncm91cE1lbWJlcnNoaXAiOlsiY249c2l0LW5ld3MtbWVtYmVyLG91PWFwcDR5b3Usb3U9YXBwcyxvPWdsb2JhbCIsImNuPWFsbC1zZGwsb3U9YXBwNHlvdSxvdT1hcHBzLG89Z2xvYmFsIiwiY249YWxsLXN6ZCxvdT1hcHA0eW91LG91PWFwcHMsbz1nbG9iYWwiLCJjbj1zaXQtbWVtYmVyLG91PWFwcDR5b3Usb3U9YXBwcyxvPWdsb2JhbCIsImNuPWdldHNtYXJ0LW5nLWFwcC1zYm94LG91PWdldHNtYXJ0LG91PWFwcHMsbz1nbG9iYWwiLCJjbj1hcmliYS1pbnQtaW50ZXJuLG91PWFyaWJhLG91PWFwcHMsbz1nbG9iYWwiLCJjbj1hbGwtc2l0LG91PWFwcDR5b3Usb3U9YXBwcyxvPWdsb2JhbCIsImNuPWdldHNtYXJ0LW5nLWxpZGwtaW50LWNvcGUsb3U9Z2V0c21hcnQsb3U9YXBwcyxvPWdsb2JhbCIsImNuPWZpbGU0eW91LWludC1BY2Nlc3Msb3U9ZmlsZTR5b3Usb3U9YXBwcyxvPWdsb2JhbCIsImNuPW9kai1pbnQtc2l0LWJjZC1vZGotdXNlcixvdT1vZGosb3U9YXBwcyxvPWdsb2JhbCIsImNuPXN0YWNraXQtcG9ydGFsLXh4LWFjY291bnQtbWVtYmVyLG91PXN0YWNraXQtcG9ydGFsLG91PWFwcHMsbz1nbG9iYWwiLCJjbj1zbnlrLXh4LXNpdC1tYWdpYy1tb25pdG9yaW5nLWFkbSxvdT1zbnlrLG91PWFwcHMsbz1nbG9iYWwiLCJjbj1hcnRpZmFjdG9yeS14eC1zaXQtbWFnaWMtbW9uaXRvcmluZy1yZHIsb3U9YXJ0aWZhY3Rvcnksb3U9YXBwcyxvPWdsb2JhbCIsImNuPW9kai1pbnQtc2l0LWJjZC1zdWItc3ViLWVhbS1kZXYsb3U9b2RqLG91PWFwcHMsbz1nbG9iYWwiLCJjbj1zbnlrLXh4LXNpdC1vZGotYXBpZW5hYmxlbWVudC1hZG0sb3U9c255ayxvdT1hcHBzLG89Z2xvYmFsIiwiY249c29uYXJxdWJlLXh4LXNpdC1vZGotYXBpZW5hYmxlbWVudC1jb24sb3U9c29uYXJxdWJlLG91PWFwcHMsbz1nbG9iYWwiLCJjbj1hcnRpZmFjdG9yeS14eC1zaXQtb2RqLWFwaWVuYWJsZW1lbnQtYWRtLG91PWFydGlmYWN0b3J5LG91PWFwcHMsbz1nbG9iYWwiLCJjbj1naXRlYS14eC12Y3MtYWNjZXNzLG91PWdpdGVhLG91PWFwcHMsbz1nbG9iYWwiLCJjbj1wdWxzZS12cG4tbC1pbnQsb3U9cHVsc2Usb3U9YXBwcyxvPWdsb2JhbCIsImNuPWFydGlmYWN0b3J5LXh4LXNpdC1vZGotam9oYW5uZXMtbWVldHMtb2RqLWFkbSxvdT1hcnRpZmFjdG9yeSxvdT1hcHBzLG89Z2xvYmFsIiwiY249c255ay14eC1zaXQtb2RqLWpvaGFubmVzLW1lZXRzLW9kai1hZG0sb3U9c255ayxvdT1hcHBzLG89Z2xvYmFsIiwiY249c29uYXJxdWJlLXh4LXNpdC1vZGotam9oYW5uZXMtbWVldHMtb2RqLWNvbixvdT1zb25hcnF1YmUsb3U9YXBwcyxvPWdsb2JhbCIsImNuPW9kai1pbnQtc2l0LWJjZC1zdWItc3ViLW1vbml0b3Jpbmctc2Nod2Fyei1kZXYsb3U9b2RqLG91PWFwcHMsbz1nbG9iYWwiLCJjbj1zbnlrLXh4LXNpdC1vZGotYWxlcnRpbmctc2Nod2Fyei1hZG0sb3U9c255ayxvdT1hcHBzLG89Z2xvYmFsIiwiY249c29uYXJxdWJlLXh4LXNpdC1vZGotYWxlcnRpbmctc2Nod2Fyei1jb24sb3U9c29uYXJxdWJlLG91PWFwcHMsbz1nbG9iYWwiLCJjbj1hcnRpZmFjdG9yeS14eC1zaXQtb2RqLWFsZXJ0aW5nLXNjaHdhcnotYWRtLG91PWFydGlmYWN0b3J5LG91PWFwcHMsbz1nbG9iYWwiLCJjbj1hcnRpZmFjdG9yeS14eC1zaXQtbW9uaXRvcmluZy1zY2h3YXJ6LWFkbSxvdT1hcnRpZmFjdG9yeSxvdT1hcHBzLG89Z2xvYmFsIiwiY249c255ay14eC1zaXQtb2RqLW1vbml0b3Jpbmctc2Nod2Fyei1hZG0sb3U9c255ayxvdT1hcHBzLG89Z2xvYmFsIiwiY249c255ay14eC1zaXQtb2RqLW1vbml0b3Jpbmctc2Nod2Fyei1jb24sb3U9c255ayxvdT1hcHBzLG89Z2xvYmFsIiwiY249c255ay14eC1zaXQtb2RqLWVhbS1iYXNpYy1hZG0sb3U9c255ayxvdT1hcHBzLG89Z2xvYmFsIiwiY249c29uYXJxdWJlLXh4LXNpdC1vZGotdGVzdHRsMTIzNC1jb24sb3U9c29uYXJxdWJlLG91PWFwcHMsbz1nbG9iYWwiLCJjbj1zbnlrLXh4LXNpdC1vZGotY29udGFjdHVpMDgxNS1hZG0sb3U9c255ayxvdT1hcHBzLG89Z2xvYmFsIiwiY249c255ay14eC1zaXQtb2RqLWVhbS1hei1hLWFkbSxvdT1zbnlrLG91PWFwcHMsbz1nbG9iYWwiLCJjbj1zb25hcnF1YmUteHgtc2l0LW9kai1jb250YWN0dWkwODE1LWNvbixvdT1zb25hcnF1YmUsb3U9YXBwcyxvPWdsb2JhbCIsImNuPXNvbmFycXViZS14eC1zaXQtb2RqLWVhbS1iYXNpYy1jb24sb3U9c29uYXJxdWJlLG91PWFwcHMsbz1nbG9iYWwiLCJjbj1zbnlrLXh4LXNpdC1vZGotdGVzdHRsMTIzNC1hZG0sb3U9c255ayxvdT1hcHBzLG89Z2xvYmFsIiwiY249c29uYXJxdWJlLXh4LXNpdC1vZGotbW9uaXRvcmluZy1zY2h3YXJ6LWNvbixvdT1zb25hcnF1YmUsb3U9YXBwcyxvPWdsb2JhbCIsImNuPXNueWsteHgtc2l0LW9kai1hZGRyZXNzYm9va3Bhc2NhbC1hZG0sb3U9c255ayxvdT1hcHBzLG89Z2xvYmFsIiwiY249YXJ0aWZhY3RvcnkteHgtc2l0LWFkZHJlc3Nib29rcGFzY2FsLWFkbSxvdT1hcnRpZmFjdG9yeSxvdT1hcHBzLG89Z2xvYmFsIiwiY249YXJ0aWZhY3RvcnkteHgtc2l0LWNsb3Vkc3VydmV5cy1hZG0sb3U9YXJ0aWZhY3Rvcnksb3U9YXBwcyxvPWdsb2JhbCIsImNuPXNueWsteHgtc2l0LW9kai1jbG91ZHN1cnZleXMtYWRtLG91PXNueWssb3U9YXBwcyxvPWdsb2JhbCIsImNuPXNvbmFycXViZS14eC1zaXQtb2RqLWNsb3Vkc3VydmV5cy1jb24sb3U9c29uYXJxdWJlLG91PWFwcHMsbz1nbG9iYWwiLCJjbj1jb21tY2Fycy14eC1kd2sta29uZmlndXJpZXJlci1mZTQsb3U9Y29tbWNhcnMsb3U9YXBwcyxvPWdsb2JhbCIsImNuPWVmcy14eC1uZXRkcml2ZS1hZHMtc2Nod2Fyei1vLG91PWVmcyxvdT1hcHBzLG89Z2xvYmFsIl0sIndvcmtmb3JjZUlEIjoiMTAwMjQ2OTc2MiIsIl90YXJnZXQiOiJJZGVudGl0eVByb3ZpZGVyUlNVRSJ9.Sz3MCQOpjKeZF6Tgg8zsuHlItYEGIBf1J4aMrSaU_ImZxoDNw0A8Bw2ihCcjTpCrZui-Z5GbRRnUowFQPcPk9OtRTG0INbP2GKrzoq7AN9g2bGFfPwlXmcyiedJLwGzhxgd2k8rcCsAu79LGPtTFXrtQ_2oIfPhBzoj5gyEG4QqJaQ8UXOpZTBcNYtaTB4I-FUumkFGmE72ljhj4lWQcOfp8rAZJRH35KI_veFvFJlGjVb3H1fy2AhQ2gTXS5Y5jIMIt0zFj7yv1XuauXgnmGgm3OIvosyj5cgqsXKTbFDLS8IquqKzGLusCaeq7fx4wjcKy2tDZvBGJbGqkGRRzlg"

var verifier *oauth.Verifier

func main() {
	var ok error
	if verifier, ok = oauth.NewVerifier(); ok != nil {
		panic("Can't get SIAM public keys")
	}

	var jwt oauth.Jwt
	if jwt, ok = oauth.DecodeJWT(jwtRaw); ok != nil {
		panic(ok)
	}

	if ok = verifier.Verify(jwt); ok == nil {
		fmt.Println("Your SIAM JWT access token is signed correct")
	} else {
		fmt.Printf("You SIAM JWT access token is not valid. Error was %s\n", ok)
	}
}
